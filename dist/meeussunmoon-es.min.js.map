{"version":3,"file":"meeussunmoon-es.min.js","sources":["../src/auxMath.js","../src/timeConversions.js","../src/moonPhases.js","../src/constants.js","../src/sunTimes.js","../src/index.js"],"sourcesContent":["/**\n * Converts angles in degrees to radians.\n * @param {number} deg Angle in degrees.\n * @returns {number} Angle in radians.\n */\nconst deg2rad = function (deg) {\n  return deg * 0.017453292519943295;\n};\n\n/**\n * Converts angles in radians to degrees.\n * @param {number} rad Angle in radians.\n * @returns {number} Angle in degrees.\n */\nconst rad2deg = function (rad) {\n  return rad * 57.29577951308232;\n};\n\n/**\n * Calculates the sine of an angle given in degrees.\n * @param {number} deg Angle in degrees.\n * @returns {number} Sine of the angle.\n */\nconst sind = function (deg) {\n  return Math.sin(deg2rad(deg));\n};\n\n/**\n * Calculates the cosine of an angle given in degrees.\n * @param {number} deg Angle in degrees.\n * @returns {number} Cosine of the angle.\n */\nconst cosd = function (deg) {\n  return Math.cos(deg2rad(deg));\n};\n\n/**\n * Reduces an angle to the interval 0-360°.\n * @param {number} angle Angle in degrees.\n * @returns {number} Reduced angle in degrees.\n */\nconst reduceAngle = function (angle) {\n  return angle - (360 * Math.floor(angle / 360));\n};\n\n/**\n * Takes the modulo of a number using floored division.\n * @param {number} a Original number.\n * @param {number} n divisor.\n * @returns {number} a mod n.\n */\nconst modulo = function (a, n) {\n  return a - n * (Math.floor(a / n));\n};\n\n/**\n * Evaluates a polynomial in the form A + Bx + Cx^2...\n * @param {number} variable Value of x in the polynomial.\n * @param {array} coeffs Array of coefficients [A, B, C...].\n * @returns {number} Sum of the polynomial.\n */\nconst polynomial = function (variable, coeffs) {\n  let varPower = 1;\n  let sum = 0.0;\n  const numCoeffs = coeffs.length;\n  for (let i = 0; i < numCoeffs; i++) {\n    sum += varPower * coeffs[i];\n    varPower *= variable;\n  }\n  return sum;\n};\n\n/**\n * Interpolates a value from 3 known values (see AA p24 Eq3.3).\n * @param {number} y1 Start value of the interval.\n * @param {number} y2 Middle value of the interval.\n * @param {number} y3 End value of the interval.\n * @param {number} n Location (-0.5 >= n >= 0.5) of result in the interval.\n * @param {bool} normalize Whether the final result should be normalized.\n * @returns {number} Interpolated result.\n */\nconst interpolateFromThree = function (y1, y2, y3, n, normalize) {\n  let a = y2 - y1;\n  let b = y3 - y2;\n  if (typeof normalize !== 'undefined' && normalize) {\n    if (a < 0) { a += 360; }\n    if (b < 0) { b += 360; }\n  }\n  const c = b - a;\n  const y = y2 + (n / 2) * (a + b + n * c);\n  return y;\n};\n\nexport {deg2rad, rad2deg, sind, cosd, reduceAngle, modulo, polynomial,\n  interpolateFromThree};\n","/**\n * Converts a datetime in UTC to the corresponding Julian Date (see AA p60f).\n * @param {moment} datetime Datetime to be converted.\n * @returns {number} Julian date (fractional number of days since 1 January\n *     4713BC according to the proleptic Julian calendar.\n */\nconst datetimeToJD = function (datetime) {\n  let Y = datetime.year();\n  // Months are zero-indexed\n  let M = datetime.month() + 1;\n  const D = datetime.date() + (datetime.hour() + (datetime.minute() +\n                               datetime.second() / 60) / 60) / 24;\n  if (M < 3) {\n    Y -= 1;\n    M += 12;\n  }\n  const A = Math.floor(Y / 100);\n  // Need a different B if we are before introduction of the Gregorian Calendar\n  const gregorianCutoff = moment('1582-10-15T12:00:00Z');\n  let B = 0;\n  if (datetime.isAfter(gregorianCutoff)) {\n    B = 2 - A + Math.floor(A / 4);\n  }\n  const JD = Math.floor(365.25 * (Y + 4716)) +\n             Math.floor(30.6001 * (M + 1)) + D + B - 1524.5;\n  return JD;\n};\n\n/**\n * Converts a Julian Date to the corresponding datetime in UTC (see AA p63).\n * @param {number} JD Julian date to be converted\n * @returns {moment} Datetime corresponding to the given Julian date.\n */\nconst JDToDatetime = function (JD) {\n  JD += 0.5;\n  const Z = Math.floor(JD);\n  const F = JD - Z;\n  let A = Z;\n  if (Z >= 2299161) {\n    const alpha = Math.floor((Z - 1867216.25) / 36524.25);\n    A += 1 + alpha - Math.floor(alpha / 4);\n  }\n  const B = A + 1524;\n  const C = Math.floor((B - 122.1) / 365.25);\n  const D = Math.floor(365.25 * C);\n  const E = Math.floor((B - D) / 30.6001);\n  const fracDay = B - D - Math.floor(30.6001 * E) + F;\n  const day = Math.floor(fracDay);\n  const hours = Math.floor((fracDay - day) * 24);\n  const minutes = Math.floor(((fracDay - day) * 24 - hours) * 60);\n  const seconds =\n    Math.floor((((fracDay - day) * 24 - hours) * 60 - minutes) * 60);\n  let month = E - 1;\n  if (E > 13) {\n    month -= 12;\n  }\n  let year = C - 4715;\n  if (month > 2) {\n    year -= 1;\n  }\n  const datetime = moment.tz('2000-01-01T12:00:00', 'UTC');\n  datetime.year(year);\n  // Months are zero-indexed\n  datetime.month(month - 1);\n  datetime.date(day);\n  datetime.hour(hours);\n  datetime.minute(minutes);\n  datetime.second(seconds);\n  return datetime;\n};\n\n/**\n * Converts a Julian date to the number of Julian centuries since\n * 2000-01-01T12:00:00Z (see AA p87 Eq12.1).\n * @param {number} JD Julian date.\n * @returns {number} T.\n */\nconst JDToT = function (JD) {\n  return (JD - 2451545) / 36525;\n};\n\n/**\n * Converts a datetime in UTC to the number of Julian centuries since\n * 2000-01-01T12:00:00Z.\n * @param {moment} datetime Datetime to be converted.\n * @returns {number} T.\n */\nconst datetimeToT = function (datetime) {\n  return JDToT(datetimeToJD(datetime));\n};\n\n/* eslint-disable complexity */\n/**\n * Calculates the value of ΔT=TT−UT (see\n * http://eclipse.gsfc.nasa.gov/SEcat5/deltatpoly.htm).\n * @param {moment} datetime Datetime for which ΔT should be calculated.\n * @returns {number} ΔT.\n */\nconst DeltaT = function (datetime) {\n  let y = datetime.year();\n  // Months are zero-indexed\n  y += (datetime.month() + 0.5) / 12;\n  let u;\n  let t;\n  let DeltaT;\n  switch (true) {\n    case y < -1999:\n      DeltaT = false;\n      break;\n    case y < -500:\n      u = (y - 1820) / 100;\n      DeltaT = -20 + 32 * u * u;\n      break;\n    case y < 500:\n      u = y / 100;\n      DeltaT = 10583.6 - 1014.41 * u + 33.78311 * u * u - 5.952053 * u * u * u -\n               0.1798452 * u * u * u * u + 0.022174192 * u * u * u * u * u +\n               0.0090316521 * u * u * u * u * u * u;\n      break;\n    case y < 1600:\n      u = (y - 1000) / 100;\n      DeltaT = 1574.2 - 556.01 * u + 71.23472 * u * u + 0.319781 * u * u * u -\n               0.8503463 * u * u * u * u - 0.005050998 * u * u * u * u * u +\n               0.0083572073 * u * u * u * u * u * u;\n      break;\n    case y < 1700:\n      t = y - 1600;\n      DeltaT = 120 - 0.9808 * t - 0.01532 * t * t + t * t * t / 7129;\n      break;\n    case y < 1800:\n      t = y - 1700;\n      DeltaT = 8.83 + 0.1603 * t - 0.0059285 * t * t + 0.00013336 * t * t * t -\n               t * t * t * t / 1174000;\n      break;\n    case y < 1860:\n      t = y - 1800;\n      DeltaT = 13.72 - 0.332447 * t + 0.0068612 * t * t +\n               0.0041116 * t * t * t - 0.00037436 * t * t * t * t +\n               0.0000121272 * t * t * t * t * t -\n               0.0000001699 * t * t * t * t * t * t +\n               0.000000000875 * t * t * t * t * t * t * t;\n      break;\n    case y < 1900:\n      t = y - 1860;\n      DeltaT = 7.62 + 0.5737 * t - 0.251754 * t * t + 0.01680668 * t * t * t -\n               0.0004473624 * t * t * t * t + t * t * t * t * t / 233174;\n      break;\n    case y < 1920:\n      t = y - 1900;\n      DeltaT = -2.79 + 1.494119 * t - 0.0598939 * t * t +\n                0.0061966 * t * t * t - 0.000197 * t * t * t * t;\n      break;\n    case y < 1941:\n      t = y - 1920;\n      DeltaT = 21.20 + 0.84493 * t - 0.076100 * t * t + 0.0020936 * t * t * t;\n      break;\n    case y < 1961:\n      t = y - 1950;\n      DeltaT = 29.07 + 0.407 * t - t * t / 233 + t * t * t / 2547;\n      break;\n    case y < 1986:\n      t = y - 1975;\n      DeltaT = 45.45 + 1.067 * t - t * t / 260 - t * t * t / 718;\n      break;\n    case y < 2005:\n      t = y - 2000;\n      DeltaT = 63.86 + 0.3345 * t - 0.060374 * t * t + 0.0017275 * t * t * t +\n               0.000651814 * t * t * t * t + 0.00002373599 * t * t * t * t * t;\n      break;\n    case y < 2050:\n      t = y - 2000;\n      DeltaT = 62.92 + 0.32217 * t + 0.005589 * t * t;\n      break;\n    case y < 2150:\n      DeltaT = -20 + 32 * ((y - 1820) / 100) * ((y - 1820) / 100) -\n        0.5628 * (2150 - y);\n      break;\n    default:\n      u = (y - 1820) / 100;\n      DeltaT = -20 + 32 * u * u;\n  }\n  return DeltaT;\n};\n/* eslint-enable complexity */\n\n/**\n * Calculates an approximate value for k (the fractional number of new moons\n * since 2000-01-06).\n * @param {moment} datetime Datetime for which k is calculated.\n * @returns {number} k.\n */\nconst approxK = function (datetime) {\n  const year = datetime.year() + (datetime.month() + 1) / 12 +\n    datetime.date() / 365.25;\n  return (year - 2000) * 12.3685;\n};\n\n/**\n * Calculates T from k.\n * @param {number} k Fractional number of new moons since 2000-01-06.\n * @returns {number} T Fractional num. of centuries since 2000-01-01:12:00:00Z.\n */\nconst kToT = function (k) {\n  return k / 1236.85;\n};\n\nexport {datetimeToJD, JDToDatetime, JDToT, datetimeToT, DeltaT, approxK, kToT};\n","import * as auxMath from './auxMath.js';\nimport * as timeConversions from './timeConversions.js';\n\n/**\n * Calculates the Julian date in ephemeris time of the moon near the date\n * corresponding to k (see AA p350ff).\n * @param {number} k The approximate fractional number of new moons since\n *     2000-01-06.\n * @param {int} phase 0 -> new moon, 1 -> first quarter,\n *                    2 -> full moon, 3 -> last quarter.\n * @returns {number} Julian date in ephemeris time of the moon of given phase.\n */\nconst truePhase = function (k, phase) {\n  k += phase / 4;\n  const T = timeConversions.kToT(k);\n  const E = eccentricityCorrection(T);\n  let JDE = meanPhase(T, k);\n  const M = sunMeanAnomaly(T, k);\n  const MPrime = moonMeanAnomaly(T, k);\n  const F = moonArgumentOfLatitude(T, k);\n  const Omega = moonAscendingNodeLongitude(T, k);\n  const A = planetaryArguments(T, k);\n  let DeltaJDE = 0;\n  if (phase === 0 || phase === 2) {\n    DeltaJDE += newMoonFullMoonCorrections(E, M, MPrime, F, Omega, phase);\n  } else if (phase === 1 || phase === 3) {\n    DeltaJDE += quarterCorrections(E, M, MPrime, F, Omega, phase);\n  }\n  DeltaJDE += commonCorrections(A);\n  JDE += DeltaJDE;\n  return JDE;\n};\n\n/**\n * Calculates the mean phase of the moon as Julian date in ephemeris time (see\n * AA p349 Eq49.1).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @param {number} k The approximate fractional number of new moons since\n *     2000-01-06.\n * @returns {number} Julian date in ephemeris time of the moon of given mean\n *     phase.\n */\nconst meanPhase = function (T, k) {\n  const JDE = 2451550.09766 + 29.530588861 * k + 0.00015437 * T * T -\n              0.000000150 * T * T * T + 0.00000000073 * T * T * T * T;\n  return JDE;\n};\n\n/**\n * Calculates the mean anomaly of the sun (see AA p350 Eq49.4).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @param {number} k The approximate fractional number of new moons since\n *     2000-01-06.\n * @returns {number} Mean anomaly of the sun at the given time.\n */\nconst sunMeanAnomaly = function (T, k) {\n  const M = 2.5534 + 29.10535670 * k - 0.0000014 * T * T -\n            0.00000011 * T * T * T;\n  return M;\n};\n\n/**\n * Calculates the mean anomaly of the moon (see AA p350 Eq49.5).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @param {number} k The approximate fractional number of new moons since\n *     2000-01-06.\n * @returns {number} Mean anomaly of the moon at the given time.\n */\nconst moonMeanAnomaly = function (T, k) {\n  const MPrime = 201.5643 + 385.81693528 * k + 0.0107582 * T * T +\n                 0.00001238 * T * T * T - 0.000000058 * T * T * T * T;\n  return MPrime;\n};\n\n/**\n * Calculates the argument of latitude of the moon (see AA p350 Eq49.6).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @param {number} k The approximate fractional number of new moons since\n *     2000-01-06.\n * @returns {number} Argument of latitude of the moon at the given time.\n */\nconst moonArgumentOfLatitude = function (T, k) {\n  const F = 160.7108 + 390.67050284 * k - 0.0016118 * T * T -\n            0.00000227 * T * T * T + 0.000000011 * T * T * T * T;\n  return F;\n};\n\n/**\n * Calculates the longitude of the ascending node of the lunar orbit (see AA\n * p350 Eq49.7).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @param {number} k The approximate fractional number of new moons since\n *     2000-01-06.\n * @returns {number} Longitude of the ascending node of the lunar orbit at the\n *     given time.\n */\nconst moonAscendingNodeLongitude = function (T, k) {\n  const Omega = 124.7746 - 1.56375588 * k + 0.0020672 * T * T +\n                0.00000215 * T * T * T;\n  return Omega;\n};\n\n/**\n * Calculates the correction for the eccentricity of the earth's orbit.\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Eccentricity correction.\n */\nconst eccentricityCorrection = function (T) {\n  const E = 1 - 0.002516 * T - 0.0000074 * T * T;\n  return E;\n};\n\n/**\n * Calculates the planetary arguments for the moon phases (see AA p351).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @param {number} k The approximate fractional number of new moons since\n *     2000-01-06.\n * @returns {array} Planetary arguments for the moon phases.\n */\nconst planetaryArguments = function (T, k) {\n  const A = [];\n  /* eslint-disable no-multi-spaces */\n  // Want to follow the numbering conventions from AA\n  A[0]  = 0;\n  A[1]  = 299.77 +  0.107408 * k - 0.009173 * T * T;\n  A[2]  = 251.88 +  0.016321 * k;\n  A[3]  = 251.83 + 26.651886 * k;\n  A[4]  = 349.42 + 36.412478 * k;\n  A[5]  =  84.66 + 18.206239 * k;\n  A[6]  = 141.74 + 53.303771 * k;\n  A[7]  = 207.14 +  2.453732 * k;\n  A[8]  = 154.84 +  7.306860 * k;\n  A[9]  =  34.52 + 27.261239 * k;\n  A[10] = 207.19 +  0.121824 * k;\n  A[11] = 291.34 +  1.844379 * k;\n  A[12] = 161.72 + 24.198154 * k;\n  A[13] = 239.56 + 25.513099 * k;\n  A[14] = 331.55 +  3.592518 * k;\n  /* eslint-enable no-multi-spaces */\n  return A;\n};\n\n/**\n * Calculates the corrections to the planetary arguments for the moon phases\n * that are common to all phases (see AA p352).\n * @param {array} A Array of planetary arguments\n * @returns {number} Correction to the Julian date in ephemeris time for the\n *     moon phase.\n */\nconst commonCorrections = function (A) {\n  const DeltaJDE = 0.000325 * auxMath.sind(A[1]) +\n                   0.000165 * auxMath.sind(A[2]) +\n                   0.000164 * auxMath.sind(A[3]) +\n                   0.000126 * auxMath.sind(A[4]) +\n                   0.000110 * auxMath.sind(A[5]) +\n                   0.000062 * auxMath.sind(A[6]) +\n                   0.000060 * auxMath.sind(A[7]) +\n                   0.000056 * auxMath.sind(A[8]) +\n                   0.000047 * auxMath.sind(A[9]) +\n                   0.000042 * auxMath.sind(A[10]) +\n                   0.000040 * auxMath.sind(A[11]) +\n                   0.000037 * auxMath.sind(A[12]) +\n                   0.000035 * auxMath.sind(A[13]) +\n                   0.000023 * auxMath.sind(A[14]);\n  return DeltaJDE;\n};\n\n/**\n * Calculates the corrections to the planetary arguments for the moon phases\n * for full and new moons (see AA p351).\n * @param {number} E Correction for the eccentricity of the earth's orbit.\n * @param {number} M Mean anomaly of the sun.\n * @param {number} MPrime Mean anomaly of the moon.\n * @param {number} F Argument of latitude of the moon.\n * @param {number} Omega Longitude of the ascending node of the lunar orbit.\n * @param {int} phase 0 -> new moon, 1 -> first quarter,\n *                    2 -> full moon, 3 -> last quarter.\n * @returns {number} Correction to the Julian date in ephemeris time for the\n *     moon phase.\n */\nconst newMoonFullMoonCorrections = function (E, M, MPrime, F, Omega, phase) {\n  let DeltaJDE = -0.00111 * auxMath.sind(MPrime - 2 * F) -\n                  0.00057 * auxMath.sind(MPrime + 2 * F) +\n                  0.00056 * E * auxMath.sind(2 * MPrime + M) -\n                  0.00042 * auxMath.sind(3 * MPrime) +\n                  0.00042 * E * auxMath.sind(M + 2 * F) +\n                  0.00038 * E * auxMath.sind(M - 2 * F) -\n                  0.00024 * E * auxMath.sind(2 * MPrime - M) -\n                  0.00017 * auxMath.sind(Omega) -\n                  0.00007 * auxMath.sind(MPrime + 2 * M) +\n                  0.00004 * auxMath.sind(2 * MPrime - 2 * F) +\n                  0.00004 * auxMath.sind(3 * M) +\n                  0.00003 * auxMath.sind(MPrime + M - 2 * F) +\n                  0.00003 * auxMath.sind(2 * MPrime + 2 * F) -\n                  0.00003 * auxMath.sind(MPrime + M + 2 * F) +\n                  0.00003 * auxMath.sind(MPrime - M + 2 * F) -\n                  0.00002 * auxMath.sind(MPrime - M - 2 * F) -\n                  0.00002 * auxMath.sind(3 * MPrime + M) +\n                  0.00002 * auxMath.sind(4 * MPrime);\n  if (phase === 0) {\n    DeltaJDE += -0.40720 * auxMath.sind(MPrime) +\n                 0.17241 * E * auxMath.sind(M) +\n                 0.01608 * auxMath.sind(2 * MPrime) +\n                 0.01039 * auxMath.sind(2 * F) +\n                 0.00739 * E * auxMath.sind(MPrime - M) -\n                 0.00514 * E * auxMath.sind(MPrime + M) +\n                 0.00208 * E * E * auxMath.sind(2 * M);\n  } else if (phase === 2) {\n    DeltaJDE += -0.40614 * auxMath.sind(MPrime) +\n                 0.17302 * E * auxMath.sind(M) +\n                 0.01614 * auxMath.sind(2 * MPrime) +\n                 0.01043 * auxMath.sind(2 * F) +\n                 0.00734 * E * auxMath.sind(MPrime - M) -\n                 0.00515 * E * auxMath.sind(MPrime + M) +\n                 0.00209 * E * E * auxMath.sind(2 * M);\n  }\n  return DeltaJDE;\n};\n\n/**\n * Calculates the corrections to the planetary arguments for the moon phases\n * for first and last quarters (see AA p352).\n * @param {number} E Correction for the eccentricity of the earth's orbit.\n * @param {number} M Mean anomaly of the sun.\n * @param {number} MPrime Mean anomaly of the moon.\n * @param {number} F Argument of latitude of the moon.\n * @param {number} Omega Longitude of the ascending node of the lunar orbit.\n * @param {int} phase 0 -> new moon, 1 -> first quarter,\n *                    2 -> full moon, 3 -> last quarter.\n * @returns {number} Correction to the Julian date in ephemeris time for the\n *     moon phase.\n */\nconst quarterCorrections = function (E, M, MPrime, F, Omega, phase) {\n  let DeltaJDE = -0.62801 * auxMath.sind(MPrime) +\n                  0.17172 * E * auxMath.sind(M) -\n                  0.01183 * E * auxMath.sind(MPrime + M) +\n                  0.00862 * auxMath.sind(2 * MPrime) +\n                  0.00804 * auxMath.sind(2 * F) +\n                  0.00454 * E * auxMath.sind(MPrime - M) +\n                  0.00204 * E * E * auxMath.sind(2 * M) -\n                  0.00180 * auxMath.sind(MPrime - 2 * F) -\n                  0.00070 * auxMath.sind(MPrime + 2 * F) -\n                  0.00040 * auxMath.sind(3 * MPrime) -\n                  0.00034 * E * auxMath.sind(2 * MPrime - M) +\n                  0.00032 * E * auxMath.sind(M + 2 * F) +\n                  0.00032 * E * auxMath.sind(M - 2 * F) -\n                  0.00028 * E * E * auxMath.sind(MPrime + 2 * M) +\n                  0.00027 * E * auxMath.sind(2 * MPrime + M) -\n                  0.00017 * auxMath.sind(Omega) -\n                  0.00005 * auxMath.sind(MPrime - M - 2 * F) +\n                  0.00004 * auxMath.sind(2 * MPrime + 2 * F) -\n                  0.00004 * auxMath.sind(MPrime + M + 2 * F) +\n                  0.00004 * auxMath.sind(MPrime - 2 * M) +\n                  0.00003 * auxMath.sind(MPrime + M - 2 * F) +\n                  0.00003 * auxMath.sind(3 * M) +\n                  0.00002 * auxMath.sind(2 * MPrime - 2 * F) +\n                  0.00002 * auxMath.sind(MPrime - M + 2 * F) -\n                  0.00002 * auxMath.sind(3 * MPrime + M);\n  const W = 0.00306 -\n            0.00038 * E * auxMath.cosd(M) +\n            0.00026 * auxMath.cosd(MPrime) -\n            0.00002 * auxMath.cosd(MPrime - M) +\n            0.00002 * auxMath.cosd(MPrime + M) +\n            0.00002 * auxMath.cosd(2 * F);\n  if (phase === 1) {\n    DeltaJDE += W;\n  } else if (phase === 3) {\n    DeltaJDE -= W;\n  }\n  return DeltaJDE;\n};\n\nexport {truePhase};\n","/* eslint array-bracket-spacing: \"off\", indent: \"off\", no-multi-spaces: \"off\", standard/array-bracket-even-spacing: \"off\" */\n\n/** See AA p144 */\nconst sunMeanAnomaly = [357.52772, 35999.050340, -0.0001603, -1 / 300000];\n\n/** See AA p163 Eq 25.2 */\nconst sunMeanLongitude = [280.46646, 36000.76983, 0.0003032];\n\n/** See AA p147 Eq22.3 */\nconst meanObliquityOfEcliptic =\n  [84381.448 / 3600, -4680.93 / 3600, -1.55 / 3600, 1999.25 / 3600,\n   -51.38 / 3600, -249.67 / 3600, -39.05 / 3600, 7.12 / 3600, 27.87 / 3600,\n   5.79 / 3600, 2.45 / 3600];\n\n/** See AA p144 */\nconst moonArgumentOfLatitude =\n  [93.27191, 483202.017538, -0.0036825, 1 / 327270];\n\n/** See AA p144 */\nconst moonAscendingNodeLongitude =\n  [125.04452, -1934.136261, 0.0020708, 1 / 450000];\n\n/** See AA p144 */\nconst moonMeanAnomaly = [134.96298, 477198.867398, 0.0086972, 1 / 56250];\n\n/** See AA p144 */\nconst moonMeanElongation = [297.85036, 445267.111480, -0.0019142, 1 / 189474];\n\n/**\n * Nutations in longitude and obliquity\n * See AA p145f\n */\nconst nutations =\n  [[ 0,  0,  0,  0, 1, -171996, -174.2, 92025,  8.9],\n   [-2,  0,  0,  2, 2,  -13187,   -1.6,  5736, -3.1],\n   [ 0,  0,  0,  2, 2,   -2274,   -0.2,   977, -0.5],\n   [ 0,  0,  0,  0, 2,    2062,    0.2,  -895,  0.5],\n   [ 0,  1,  0,  0, 0,    1426,   -3.4,    54, -0.1],\n   [ 0,  0,  1,  0, 0,     712,    0.1,    -7,    0],\n   [-2,  1,  0,  2, 2,    -517,    1.2,   224, -0.6],\n   [ 0,  0,  0,  2, 1,    -386,   -0.4,   200,    0],\n   [ 0,  0,  1,  2, 2,    -301,      0,   129, -0.1],\n   [-2, -1,  0,  2, 2,     217,   -0.5,   -95,  0.3],\n   [-2,  0,  1,  0, 0,    -158,      0,     0,    0],\n   [-2,  0,  0,  2, 1,     129,    0.1,   -70,    0],\n   [ 0,  0, -1,  2, 2,     123,      0,   -53,    0],\n   [ 2,  0,  0,  0, 0,      63,      0,     0,    0],\n   [ 0,  0,  1,  0, 1,      63,    0.1,   -33,    0],\n   [ 2,  0, -1,  2, 2,     -59,      0,    26,    0],\n   [ 0,  0, -1,  0, 1,     -58,   -0.1,    32,    0],\n   [ 0,  0,  1,  2, 1,     -51,      0,    27,    0],\n   [-2,  0,  2,  0, 0,      48,      0,     0,    0],\n   [ 0,  0, -2,  2, 1,      46,      0,   -24,    0],\n   [ 2,  0,  0,  2, 2,     -38,      0,    16,    0],\n   [ 0,  0,  2,  2, 2,     -31,      0,    13,    0],\n   [ 0,  0,  2,  0, 0,      29,      0,     0,    0],\n   [-2,  0,  1,  2, 2,      29,      0,   -12,    0],\n   [ 0,  0,  0,  2, 0,      26,      0,     0,    0],\n   [-2,  0,  0,  2, 0,     -22,      0,     0,    0],\n   [ 0,  0, -1,  2, 1,      21,      0,   -10,    0],\n   [ 0,  2,  0,  0, 0,      17,   -0.1,     0,    0],\n   [ 2,  0, -1,  0, 1,      16,      0,    -8,    0],\n   [-2,  2,  0,  2, 2,     -16,    0.1,     7,    0],\n   [ 0,  1,  0,  0, 1,     -15,      0,     9,    0],\n   [-2,  0,  1,  0, 1,     -13,      0,     7,    0],\n   [ 0, -1,  0,  0, 1,     -12,      0,     6,    0],\n   [ 0,  0,  2, -2, 0,      11,      0,     0,    0],\n   [ 2,  0, -1,  2, 1,     -10,      0,     5,    0],\n   [ 2,  0,  1,  2, 2,     -8,       0,     3,    0],\n   [ 0,  1,  0,  2, 2,      7,       0,    -3,    0],\n   [-2,  1,  1,  0, 0,     -7,       0,     0,    0],\n   [ 0, -1,  0,  2, 2,     -7,       0,     3,    0],\n   [ 2,  0,  0,  2, 1,     -7,       0,     3,    0],\n   [ 2,  0,  1,  0, 0,      6,       0,     0,    0],\n   [-2,  0,  2,  2, 2,      6,       0,    -3,    0],\n   [-2,  0,  1,  2, 1,      6,       0,    -3,    0],\n   [ 2,  0, -2,  0, 1,     -6,       0,     3,    0],\n   [ 2,  0,  0,  0, 1,     -6,       0,     3,    0],\n   [ 0, -1,  1,  0, 0,      5,       0,     0,    0],\n   [-2, -1,  0,  2, 1,     -5,       0,     3,    0],\n   [-2,  0,  0,  0, 1,     -5,       0,     3,    0],\n   [ 0,  0,  2,  2, 1,     -5,       0,     3,    0],\n   [-2,  0,  2,  0, 1,      4,       0,     0,    0],\n   [-2,  1,  0,  2, 1,      4,       0,     0,    0],\n   [ 0,  0,  1, -2, 0,      4,       0,     0,    0],\n   [-1,  0,  1,  0, 0,     -4,       0,     0,    0],\n   [-2,  1,  0,  0, 0,     -4,       0,     0,    0],\n   [ 1,  0,  0,  0, 0,     -4,       0,     0,    0],\n   [ 0,  0,  1,  2, 0,      3,       0,     0,    0],\n   [ 0,  0, -2,  2, 2,     -3,       0,     0,    0],\n   [-1, -1,  1,  0, 0,     -3,       0,     0,    0],\n   [ 0,  1,  1,  0, 0,     -3,       0,     0,    0],\n   [ 0, -1,  1,  2, 2,     -3,       0,     0,    0],\n   [ 2, -1, -1,  2, 2,     -3,       0,     0,    0],\n   [ 0,  0,  3,  2, 2,      3,       0,     0,    0],\n   [ 2, -1,  0,  2, 2,     -3,       0,     0,    0]];\n\nexport {sunMeanAnomaly, sunMeanLongitude, meanObliquityOfEcliptic,\n  moonArgumentOfLatitude, moonAscendingNodeLongitude, moonMeanAnomaly,\n  moonMeanElongation, nutations};\n","import * as auxMath from './auxMath.js';\nimport * as constants from './constants.js';\nimport * as timeConversions from './timeConversions.js';\nimport {returnTimeForPNMS, roundToNearestMinute} from './index.js';\n\n/**\n * Calculates the solar transit time on a date at a given longitude (see AA\n * p102f).\n * @param {moment} datetime Date for which transit is calculated.\n * @param {number} L Longitude.\n * @returns {moment} Solar transit time.\n */\nconst sunTransit = function (datetime, L) {\n  const timezone = datetime.tz();\n  const transit = moment.tz(\n    [datetime.year(), datetime.month(), datetime.date(), 0, 0, 0], 'UTC');\n  const DeltaT = timeConversions.DeltaT(transit);\n  const T = timeConversions.datetimeToT(transit);\n  const Theta0 = apparentSiderealTimeGreenwhich(T);\n  // Want 0h TD for this, not UT\n  const TD = T - (DeltaT / (3600 * 24 * 36525));\n  const alpha = sunApparentRightAscension(TD);\n  // Sign flip for longitude from AA as we take East as positive\n  let m = (alpha - L - Theta0) / 360;\n  m = normalizeM(m, datetime.utcOffset());\n  const DeltaM = sunTransitCorrection(T, Theta0, DeltaT, L, m);\n  m += DeltaM;\n  transit.add(Math.floor(m * 3600 * 24 + 0.5), 'seconds');\n  if (roundToNearestMinute) {\n    transit.add(30, 'seconds');\n    transit.second(0);\n  }\n  transit.tz(timezone);\n  return transit;\n};\n\n/**\n * Calculates the sunrise or sunset time on a date at a given latitude and\n * longitude (see AA p102f).\n * @param {moment} datetime Date for which sunrise or sunset is calculated.\n * @param {number} phi Latitude.\n * @param {number} L Longitude.\n * @param {string} flag 'RISE' or 'SET' depending on which event should be\n *     calculated.\n * @param {number} offset number of degrees below the horizon for the desired\n *     event (50/60 for sunrise/set, 6 for civil, 12 for nautical, 18 for\n *     astronomical dawn/dusk.\n * @returns {moment} Sunrise or sunset time.\n */\nconst sunRiseSet = function (datetime, phi, L, flag, offset = 50 / 60) {\n  const timezone = datetime.tz();\n  const suntime = moment.tz(\n    [datetime.year(), datetime.month(), datetime.date(), 0, 0, 0], 'UTC');\n  const DeltaT = timeConversions.DeltaT(suntime);\n  const T = timeConversions.datetimeToT(suntime);\n  const Theta0 = apparentSiderealTimeGreenwhich(T);\n  // Want 0h TD for this, not UT\n  const TD = T - (DeltaT / (3600 * 24 * 36525));\n  const alpha = sunApparentRightAscension(TD);\n  const delta = sunApparentDeclination(TD);\n  const H0 = approxLocalHourAngle(phi, delta, offset);\n  // Sign flip for longitude from AA as we take East as positive\n  let m0 = (alpha - L - Theta0) / 360;\n  m0 = normalizeM(m0, datetime.utcOffset());\n  let m;\n  if (flag === 'RISE') {\n    m = m0 - H0 / 360;\n  } else if (flag === 'SET') {\n    m = m0 + H0 / 360;\n  } else {\n    return false;\n  }\n  let counter = 0;\n  let DeltaM = 1;\n  // Repeat if correction is larger than ~9s\n  while ((Math.abs(DeltaM) > 0.0001) && (counter < 3)) {\n    DeltaM = sunRiseSetCorrection(T, Theta0, DeltaT, phi, L, m, offset);\n    m += DeltaM;\n    counter++;\n  }\n  if (m > 0) {\n    suntime.add(Math.floor(m * 3600 * 24 + 0.5), 'seconds');\n  } else {\n    suntime.subtract(Math.floor(Math.abs(m) * 3600 * 24 + 0.5), 'seconds');\n  }\n  if (roundToNearestMinute) {\n    suntime.add(30, 'seconds');\n    suntime.second(0);\n  }\n  suntime.tz(timezone);\n  return suntime;\n};\n\n/**\n * Returns 06:00/18:00 (07:00/19:00 during DST) if there is no sunrise or sunset\n * on the date. If returnTimeForPNMS is true, otherwise return whether there is\n * Polar Night or Midnight Sun.\n * @param {moment} returnDate The calculated time for sunrise or sunset.\n * @param {moment} date The original date from which the event was calculated.\n * @param {int} hour Hour to which the returned datetime should be set.\n * @param {int} minute Minute to which the returned datetime should be set.\n * @returns {(moment|string)} Time given by parameter 'hour' (+ correction for\n *     DST if applicable) or a string indicating that the location experiences\n *     midnight sun ('MS') or polar night ('PN') on that date.\n */\nconst returnPNMS = function (returnDate, date, hour, minute = 0) {\n  if (returnTimeForPNMS) {\n    if (date.isDST()) {\n      hour += 1;\n    }\n    returnDate.tz(date.tz())\n      .year(date.year())\n      .month(date.month())\n      .date(date.date())\n      .hour(hour)\n      .minute(minute)\n      .second(0);\n  }\n  return returnDate;\n};\n\n/**\n * Calculates the approximate local hour angle of the sun at sunrise or sunset.\n * @param {number} phi Latitude (see AA p102 Eq15.1).\n * @param {number} delta Apparent declination of the sun.\n * @param {number} offset number of degrees below the horizon for the desired\n *     event (50/60 for sunrise/set, 6 for civil, 12 for nautical, 18 for\n *     astronomical dawn/dusk.\n * @returns {number} Approximate local hour angle.\n */\nconst approxLocalHourAngle = function (phi, delta, offset) {\n  const cosH0 = (auxMath.sind(-offset) -\n                auxMath.sind(phi) * auxMath.sind(delta)) /\n                (auxMath.cosd(phi) * auxMath.cosd(delta));\n  if (cosH0 < -1) {\n    if (returnTimeForPNMS) {\n      throw moment.tz('**2000-01-01 12:00:00', 'YYYY-MM-DD HH:mm:ss',\n        'Europe/London');\n    } else {\n      let special = 'MS';\n      if (offset === 6) {\n        special = 'NCD';\n      } else if (offset === 12) {\n        special = 'NND';\n      } else if (offset === 18) {\n        special = 'NAD';\n      }\n      throw special;\n    }\n  } else if (cosH0 > 1) {\n    if (returnTimeForPNMS) {\n      throw moment.tz('--2000-01-01 12:00:00', 'YYYY-MM-DD HH:mm:ss',\n        'Europe/London');\n    } else {\n      let special = 'PN';\n      if (offset === 6) {\n        special = 'NCD';\n      } else if (offset === 12) {\n        special = 'NND';\n      } else if (offset === 18) {\n        special = 'NAD';\n      }\n      throw special;\n    }\n  }\n  const H0 = auxMath.rad2deg(Math.acos(cosH0));\n  return H0;\n};\n\n/**\n * Normalizes a fractional time of day to be on the correct date.\n * @param {number} m Fractional time of day\n * @param {int} utcOffset Offset in minutes from UTC.\n * @returns {number} m Normalized m.\n */\nconst normalizeM = function (m, utcOffset) {\n  const localM = m + utcOffset / 1440;\n  if (localM < 0) {\n    return m + 1;\n  } else if (localM > 1) {\n    return m - 1;\n  }\n  return m;\n};\n\n/**\n * Calculates the correction for the solar transit time (see AA p103).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @param {number} Theta0 Apparent sidereal time at Greenwhich.\n * @param {number} DeltaT ΔT = TT − UT.\n * @param {number} L Longitude.\n * @param {number} m Fractional time of day of the event.\n * @returns {number} Currection for the solar transit time.\n */\nconst sunTransitCorrection = function (T, Theta0, DeltaT, L, m) {\n  const theta0 = Theta0 + 360.985647 * m;\n  const n = m + DeltaT / 864000;\n  const alpha = interpolatedRa(T, n);\n  const H = localHourAngle(theta0, L, alpha);\n  const DeltaM = -H / 360;\n  return DeltaM;\n};\n\n/**\n * Calculates the correction for the sunrise/sunset time (see AA p103).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @param {number} Theta0 Apparent sidereal time at Greenwhich.\n * @param {number} DeltaT ΔT = TT − UT.\n * @param {number} phi Latitude.\n * @param {number} L Longitude.\n * @param {number} m Fractional time of day of the event.\n * @param {number} offset number of degrees below the horizon for the desired\n *     event (50/60 for sunrise/set, 6 for civil, 12 for nautical, 18 for\n *     astronomical dawn/dusk.\n * @returns {number} Currection for the sunrise/sunset time.\n */\nconst sunRiseSetCorrection = function (T, Theta0, DeltaT, phi, L, m, offset) {\n  const theta0 = Theta0 + 360.985647 * m;\n  const n = m + DeltaT / 864000;\n  const alpha = interpolatedRa(T, n);\n  const delta = interpolatedDec(T, n);\n  const H = localHourAngle(theta0, L, alpha);\n  const h = altitude(phi, delta, H);\n  const DeltaM = (h + offset) /\n    (360 * auxMath.cosd(delta) * auxMath.cosd(phi) * auxMath.sind(H));\n  return DeltaM;\n};\n\n/**\n * Calculates the local hour angle of the sun (see AA p103).\n * @param {number} theta0 Sidereal time at Greenwhich in degrees.\n * @param {number} L Longitude.\n * @param {number} alpha Apparent right ascension of the sun.\n * @returns {number} Local hour angle of the sun.\n */\nconst localHourAngle = function (theta0, L, alpha) {\n  // Signflip for longitude\n  let H = auxMath.reduceAngle(theta0 + L - alpha);\n  if (H > 180) { H -= 360; }\n  return H;\n};\n\n/**\n * Calculates the altitude of the sun above the horizon (see AA P93 Eq13.6).\n * @param {number} phi Latitude.\n * @param {number} delta Apparent declination of the sun.\n * @param {number} H Local hour angle of the sun.\n * @returns {number} Altitude of the sun above the horizon.\n */\nconst altitude = function (phi, delta, H) {\n  const h = auxMath.rad2deg(Math.asin(\n    auxMath.sind(phi) * auxMath.sind(delta) +\n    auxMath.cosd(phi) * auxMath.cosd(delta) * auxMath.cosd(H)));\n  return h;\n};\n\n/**\n * Interpolates the sun's right ascension (see AA p103).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @param {number} n Fractional time of day of the event corrected by ΔT.\n * @returns {number} Interpolated right ascension.\n */\nconst interpolatedRa = function (T, n) {\n  const alpha1 = sunApparentRightAscension(T - (1 / 36525));\n  const alpha2 = sunApparentRightAscension(T);\n  const alpha3 = sunApparentRightAscension(T + (1 / 36525));\n  // I don't understand why the RA has to be interpolated with normalization\n  // but the Dec without, but the returned values are wrong otherwise...\n  const alpha = auxMath.interpolateFromThree(alpha1, alpha2, alpha3, n, true);\n  return auxMath.reduceAngle(alpha);\n};\n\n/**\n * Interpolates the sun's declination (see AA p103).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @param {number} n Fractional time of day of the event corrected by ΔT.\n * @returns {number} Interpolated declination.\n */\nconst interpolatedDec = function (T, n) {\n  const delta1 = sunApparentDeclination(T - (1 / 36525));\n  const delta2 = sunApparentDeclination(T);\n  const delta3 = sunApparentDeclination(T + (1 / 36525));\n  const delta = auxMath.interpolateFromThree(delta1, delta2, delta3, n);\n  return auxMath.reduceAngle(delta);\n};\n\n/**\n * Calculates the apparent right ascension of the sun (see AA p165 Eq25.6).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Apparent right ascension of the sun.\n */\nconst sunApparentRightAscension = function (T) {\n  const Omega = moonAscendingNodeLongitude(T);\n  const epsilon = trueObliquityOfEcliptic(T) +\n                  0.00256 * auxMath.cosd(Omega);\n  const lambda = sunApparentLongitude(T);\n  const alpha = auxMath.rad2deg(Math.atan2(\n    auxMath.cosd(epsilon) * auxMath.sind(lambda), auxMath.cosd(lambda)));\n  return auxMath.reduceAngle(alpha);\n};\n\n/**\n * Calculates the apparent declination of the sun (see AA p165 Eq25.7).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Apparent declination of the sun.\n */\nconst sunApparentDeclination = function (T) {\n  const Omega = moonAscendingNodeLongitude(T);\n  const epsilon = trueObliquityOfEcliptic(T) +\n                  0.00256 * auxMath.cosd(Omega);\n  const lambda = sunApparentLongitude(T);\n  const delta = auxMath.rad2deg(Math.asin(\n    auxMath.sind(epsilon) * auxMath.sind(lambda)));\n  return delta;\n};\n\n/**\n * Calculates the apparent sidereal time at Greenwhich (see AA p88).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Apparent sidereal time at Greenwhich\n */\nconst apparentSiderealTimeGreenwhich = function (T) {\n  const theta0 = meanSiderealTimeGreenwhich(T);\n  const epsilon = trueObliquityOfEcliptic(T);\n  const DeltaPsi = nutationInLongitude(T);\n  const theta = theta0 + DeltaPsi * auxMath.cosd(epsilon);\n  return auxMath.reduceAngle(theta);\n};\n\n/**\n * Calculates the mean sidereal time at Greenwhich (see AA p88 Eq12.4).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Mean sidereal time at Greenwhich\n */\nconst meanSiderealTimeGreenwhich = function (T) {\n  const JD2000 = T * 36525;\n  const theta0 = 280.46061837 + 360.98564736629 * JD2000 + 0.000387933 * T * T -\n                 T * T * T / 38710000;\n  return theta0;\n};\n\n/**\n * Calculates the true obliquity of the ecliptic (see AA p147).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} True obliquity of the ecliptic.\n */\nconst trueObliquityOfEcliptic = function (T) {\n  const epsilon0 = meanObliquityOfEcliptic(T);\n  const DeltaEpsilon = nutationInObliquity(T);\n  const epsilon = epsilon0 + DeltaEpsilon;\n  return epsilon;\n};\n\n/**\n * Calculates the mean obliquity of the ecliptic (see AA p147 Eq 22.3).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Mean obliquity of the ecliptic.\n */\nconst meanObliquityOfEcliptic = function (T) {\n  const U = T / 100;\n  const epsilon0 = auxMath.polynomial(U, constants.meanObliquityOfEcliptic);\n  return epsilon0;\n};\n\n/**\n * Calculates the apparent longitude of the sun (see AA p164).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Apparent longitude of the sun.\n */\nconst sunApparentLongitude = function (T) {\n  const Sol = sunTrueLongitude(T);\n  const Omega = moonAscendingNodeLongitude(T);\n  const lambda = Sol - 0.00569 - 0.00478 * auxMath.sind(Omega);\n  return lambda;\n};\n\n/**\n * Calculates the true longitude of the sun (see AA p164).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} True longitude of the sun.\n */\nconst sunTrueLongitude = function (T) {\n  const L0 = sunMeanLongitude(T);\n  const C = sunEquationOfCenter(T);\n  const Sol = L0 + C;\n  return Sol;\n};\n\n/**\n * Calculates the equation of center of the sun (see AA p164).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Equation of center of the sun.\n */\nconst sunEquationOfCenter = function (T) {\n  const M = sunMeanAnomaly(T);\n  const C = (1.914602 - 0.004817 * T - 0.000014 * T * T) * auxMath.sind(M) +\n            (0.019993 - 0.000101 * T) * auxMath.sind(2 * M) +\n            0.000290 * auxMath.sind(3 * M);\n  return C;\n};\n\n/**\n * Calculates the nutation in longitude of the sun (see AA p144ff).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Nutation in longitude of the sun.\n */\nconst nutationInLongitude = function (T) {\n  const D = moonMeanElongation(T);\n  const M = sunMeanAnomaly(T);\n  const MPrime = moonMeanAnomaly(T);\n  const F = moonArgumentOfLatitude(T);\n  const Omega = moonAscendingNodeLongitude(T);\n  let DeltaPsi = 0;\n  let sineArg;\n  for (let i = 0; i < 63; i++) {\n    sineArg = constants.nutations[i][0] * D +\n              constants.nutations[i][1] * M +\n              constants.nutations[i][2] * MPrime +\n              constants.nutations[i][3] * F +\n              constants.nutations[i][4] * Omega;\n    DeltaPsi += (constants.nutations[i][5] +\n                 constants.nutations[i][6] * T) * auxMath.sind(sineArg);\n  }\n  DeltaPsi /= 36000000;\n  return DeltaPsi;\n};\n\n/**\n * Calculates the nutation in obliquity of the sun (see AA p144ff).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Nutation in obliquity of the sun.\n */\nconst nutationInObliquity = function (T) {\n  const D = moonMeanElongation(T);\n  const M = sunMeanAnomaly(T);\n  const MPrime = moonMeanAnomaly(T);\n  const F = moonArgumentOfLatitude(T);\n  const Omega = moonAscendingNodeLongitude(T);\n  let DeltaEpsilon = 0;\n  let cosArg;\n  for (let i = 0; i < 63; i++) {\n    cosArg = constants.nutations[i][0] * D +\n             constants.nutations[i][1] * M +\n             constants.nutations[i][2] * MPrime +\n             constants.nutations[i][3] * F +\n             constants.nutations[i][4] * Omega;\n    DeltaEpsilon += (constants.nutations[i][7] +\n                     constants.nutations[i][8] * T) * auxMath.cosd(cosArg);\n  }\n  DeltaEpsilon /= 36000000;\n  return DeltaEpsilon;\n};\n\n/**\n * Calculates the argument of latitude of the moon (see AA p144).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Argument of latitude of the moon.\n */\nconst moonArgumentOfLatitude = function (T) {\n  const F = auxMath.polynomial(T, constants.moonArgumentOfLatitude);\n  return auxMath.reduceAngle(F);\n};\n\n/**\n * Calculates the longitude of the ascending node of the Moon's mean orbit on\n * the ecliptic, measured from the mean equinox of the datea (see AA p144).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Longitude of the asc. node of the moon's mean orbit.\n */\nconst moonAscendingNodeLongitude = function (T) {\n  const Omega = auxMath.polynomial(T, constants.moonAscendingNodeLongitude);\n  return auxMath.reduceAngle(Omega);\n};\n\n/**\n * Calculates the mean anomaly of the moon (see AA p144).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Mean anomaly of the moon.\n */\nconst moonMeanAnomaly = function (T) {\n  const MPrime = auxMath.polynomial(T, constants.moonMeanAnomaly);\n  return auxMath.reduceAngle(MPrime);\n};\n\n/**\n * Calculates the mean elongation of the moon from the sun (see AA p144).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Mean elongation of the moon from the sun.\n */\nconst moonMeanElongation = function (T) {\n  const D = auxMath.polynomial(T, constants.moonMeanElongation);\n  return auxMath.reduceAngle(D);\n};\n\n/**\n * Calculates the mean anomaly of the sun (see AA p144).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Mean anomaly of the sun.\n */\nconst sunMeanAnomaly = function (T) {\n  const M = auxMath.polynomial(T, constants.sunMeanAnomaly);\n  return auxMath.reduceAngle(M);\n};\n\n/**\n * Calculates the mean longitude of the sun referred to the mean equinox of the\n * date (see AA p163).\n * @param {number} T Fractional number of Julian centuries since\n *     2000-01-01T12:00:00Z.\n * @returns {number} Mean longitude of the sun referred to the mean equinox of\n *     the date.\n */\nconst sunMeanLongitude = function (T) {\n  const L0 = auxMath.polynomial(T, constants.sunMeanLongitude);\n  return auxMath.reduceAngle(L0);\n};\n\nexport {sunRiseSet, sunTransit, returnPNMS};\n","import * as moonPhases from './moonPhases.js';\nimport * as sunTimes from './sunTimes.js';\nimport * as timeConversions from './timeConversions.js';\n\nlet roundToNearestMinute = false;\nlet returnTimeForPNMS = false;\nlet dateFormatKeys = {'**': '‡', '--': '†'};\n\n/**\n * Sets options (roundToNearestMinute, returnTimeForPNMS, dateFormatKey) for the\n * module.\n * @param {object} options Options to be set.\n */\nconst options = function (options) {\n  if (typeof options.roundToNearestMinute === 'boolean') {\n    roundToNearestMinute = options.roundToNearestMinute;\n  }\n  if (typeof options.returnTimeForPNMS === 'boolean') {\n    returnTimeForPNMS = options.returnTimeForPNMS;\n  }\n  if (typeof options.dateFormatKeys === 'object') {\n    dateFormatKeys = options.dateFormatKeys;\n  }\n};\n\n/**\n * Uses the extra information encoded into the moment object for dates without\n * a sunrise or sunset if returnTimeForPNMS is true to mark the output string.\n * @param {moment} datetime Input datetime.\n * @param {string} formatString Valid moment format string.\n * @returns {string} Formatted string with marker appended.\n */\nconst formatCI = function (datetime, formatString) {\n  const customKey = datetime.creationData().input.slice(0, 2);\n  let datestring = datetime.format(formatString);\n  if (dateFormatKeys[customKey]) {\n    datestring += dateFormatKeys[customKey];\n  }\n  return datestring;\n};\n\n/**\n * Calculates sunrise on the provided date.\n * @param {moment} datetime Datetime for which sunrise is calculated. Should\n *     always contain a timezone or be in UTC, lone UTC offsets might lead to\n *     unexpected behaviour.\n * @param {number} phi Latitude of target location.\n * @param {number} L longitude of target location.\n * @returns {(moment|string)} Time of sunrise or a string indicating that the\n *     location experiences midnight sun ('MS') or polar night ('PN') on that\n *     date (unless returnTimeForPNMS is true).\n */\nconst sunrise = function (datetime, phi, L) {\n  let sunrise;\n  try {\n    sunrise = sunTimes.sunRiseSet(datetime, phi, L, 'RISE');\n  } catch (err) {\n    return sunTimes.returnPNMS(err, datetime, 6);\n  }\n  return sunrise;\n};\n\n/**\n * Calculates sunset on the provided date.\n * @param {moment} datetime Datetime for which sunset is calculated. Should\n *     always contain a timezone or be in UTC, lone UTC offsets might lead to\n *     unexpected behaviour.\n * @param {number} phi Latitude of target location.\n * @param {number} L longitude of target location.\n * @returns {(moment|string)} Time of sunset or a string indicating that the\n *     location experiences midnight sun ('MS') or polar night ('PN') on that\n *     date (unless returnTimeForPNMS is true).\n */\nconst sunset = function (datetime, phi, L) {\n  let sunset;\n  try {\n    sunset = sunTimes.sunRiseSet(datetime, phi, L, 'SET');\n  } catch (err) {\n    return sunTimes.returnPNMS(err, datetime, 18);\n  }\n  return sunset;\n};\n\n/**\n * Calculates civil dawn (sun 6° below horizon) on the provided date.\n * @param {moment} datetime Datetime for which civil dawn is calculated. Should\n *     always contain a timezone or be in UTC, lone UTC offsets might lead to\n *     unexpected behaviour.\n * @param {number} phi Latitude of target location.\n * @param {number} L longitude of target location.\n * @returns {(moment|string)} Time of civil dawn or a string ('NCD') indicating\n *     that the location does not experience civil dawn on that date (unless\n *     returnTimeForPNMS is true).\n */\nconst civilDawn = function (datetime, phi, L) {\n  let civilDawn;\n  try {\n    civilDawn = sunTimes.sunRiseSet(datetime, phi, L, 'RISE', 6);\n  } catch (err) {\n    return sunTimes.returnPNMS(err, datetime, 5, 30);\n  }\n  return civilDawn;\n};\n\n/**\n * Calculates civil dusk (sun 6° below horizon) on the provided date.\n * @param {moment} datetime Datetime for which civil dusk is calculated. Should\n *     always contain a timezone or be in UTC, lone UTC offsets might lead to\n *     unexpected behaviour.\n * @param {number} phi Latitude of target location.\n * @param {number} L longitude of target location.\n * @returns {(moment|string)} Time of civil dusk or a string ('NCD') indicating\n *     that the location does not experience civil dusk on that date (unless\n *     returnTimeForPNMS is true).\n */\nconst civilDusk = function (datetime, phi, L) {\n  let civilDusk;\n  try {\n    civilDusk = sunTimes.sunRiseSet(datetime, phi, L, 'SET', 6);\n  } catch (err) {\n    return sunTimes.returnPNMS(err, datetime, 18, 30);\n  }\n  return civilDusk;\n};\n\n/**\n * Calculates nautical dawn (sun 12° below horizon) on the provided date.\n * @param {moment} datetime Datetime for which nautical dawn is calculated.\n *     Should always contain a timezone or be in UTC, lone UTC offsets might\n *     lead to unexpected behaviour.\n * @param {number} phi Latitude of target location.\n * @param {number} L longitude of target location.\n * @returns {(moment|string)} Time of nautical dawn or a string ('NND')\n *     indicating that the location does not experience nautical dawn on that\n *     date (unless returnTimeForPNMS is true).\n */\nconst nauticalDawn = function (datetime, phi, L) {\n  let nauticalDawn;\n  try {\n    nauticalDawn = sunTimes.sunRiseSet(datetime, phi, L, 'RISE', 12);\n  } catch (err) {\n    return sunTimes.returnPNMS(err, datetime, 5);\n  }\n  return nauticalDawn;\n};\n\n/**\n * Calculates nautical dusk (sun 12° below horizon) on the provided date.\n * @param {moment} datetime Datetime for which nautical dusk is calculated.\n *     Should always contain a timezone or be in UTC, lone UTC offsets might\n *     lead to unexpected behaviour.\n * @param {number} phi Latitude of target location.\n * @param {number} L longitude of target location.\n * @returns {(moment|string)} Time of nautical dusk or a string ('NND')\n *     indicating that the location does not experience nautical dusk on that\n *     date (unless returnTimeForPNMS is true).\n */\nconst nauticalDusk = function (datetime, phi, L) {\n  let nauticalDusk;\n  try {\n    nauticalDusk = sunTimes.sunRiseSet(datetime, phi, L, 'SET', 12);\n  } catch (err) {\n    return sunTimes.returnPNMS(err, datetime, 19);\n  }\n  return nauticalDusk;\n};\n\n/**\n * Calculates astronomical dawn (sun 18° below horizon) on the provided date.\n * @param {moment} datetime Datetime for which astronomical dawn is calculated.\n *     Should always contain a timezone or be in UTC, lone UTC offsets might\n *     lead to unexpected behaviour.\n * @param {number} phi Latitude of target location.\n * @param {number} L longitude of target location.\n * @returns {(moment|string)} Time of astronomical dawn or a string ('NAD')\n *     indicating that the location does not experience astronomical dawn on\n *     that date (unless returnTimeForPNMS is true).\n */\nconst astronomicalDawn = function (datetime, phi, L) {\n  let astronomicalDawn;\n  try {\n    astronomicalDawn = sunTimes.sunRiseSet(datetime, phi, L, 'RISE', 18);\n  } catch (err) {\n    return sunTimes.returnPNMS(err, datetime, 4, 30);\n  }\n  return astronomicalDawn;\n};\n\n/**\n * Calculates astronomical dusk (sun 18° below horizon) on the provided date.\n * @param {moment} datetime Datetime for which astronomical dusk is calculated.\n *     Should always contain a timezone or be in UTC, lone UTC offsets might\n *     lead to unexpected behaviour.\n * @param {number} phi Latitude of target location.\n * @param {number} L longitude of target location.\n * @returns {(moment|string)} Time of astronomical dusk or a string ('NAD')\n *     indicating that the location does not experience astronomical dusk on\n *     that date (unless returnTimeForPNMS is true).\n */\nconst astronomicalDusk = function (datetime, phi, L) {\n  let astronomicalDusk;\n  try {\n    astronomicalDusk = sunTimes.sunRiseSet(datetime, phi, L, 'SET', 18);\n  } catch (err) {\n    return sunTimes.returnPNMS(err, datetime, 19, 30);\n  }\n  return astronomicalDusk;\n};\n\n/**\n * Calculates solar noon on the provided date.\n * @param {moment} datetime Datetime for which solar noon is calculated. Should\n *     always contain a timezone or be in UTC, lone UTC offsets might lead to\n *     unexpected behaviour.\n * @param {number} L longitude of target location.\n * @returns {moment} Time of solar noon at the given longitude.\n */\nconst solarNoon = function (datetime, L) {\n  const transit = sunTimes.sunTransit(datetime, L);\n  return transit;\n};\n\n/**\n * Calculates all moons of the given phase that occur within the given\n * Gregorian calendar year.\n * @param {int} year Year for which moon phases should be calculated.\n * @param {int} phase 0 -> new moon, 1 -> first quarter,\n *                    2 -> full moon, 3 -> last quarter.\n * @param {string} timezone Optional: IANA timezone string.\n * @returns {array} Array of moment objects for moons of the given phase.\n */\nconst yearMoonPhases = function (year, phase, timezone) {\n  const yearBegin = moment([year]);\n  const yearEnd = moment([year + 1]);\n  // this will give us k for the first new moon of the year or earlier\n  let k = Math.floor(timeConversions.approxK(yearBegin)) - 1;\n  // taking 15 events will make sure we catch every event in the year\n  const phaseTimes = [];\n  let JDE;\n  let moonDatetime;\n  let DeltaT;\n  for (let i = 0; i < 15; i++) {\n    JDE = moonPhases.truePhase(k, phase);\n    // we pretend it's JD and not JDE\n    moonDatetime = timeConversions.JDToDatetime(JDE);\n    // now use that to calculate deltaT\n    DeltaT = timeConversions.DeltaT(moonDatetime);\n    if (DeltaT > 0) {\n      moonDatetime.subtract(Math.abs(DeltaT), 'seconds');\n    } else {\n      moonDatetime.add(Math.abs(DeltaT), 'seconds');\n    }\n    if (roundToNearestMinute) {\n      moonDatetime.add(30, 'seconds');\n      moonDatetime.second(0);\n    }\n    if (typeof timezone === 'undefined') {\n      timezone = 'UTC';\n    }\n    moonDatetime.tz(timezone);\n    if ((moonDatetime.isAfter(yearBegin)) && (moonDatetime.isBefore(yearEnd))) {\n      phaseTimes.push(moonDatetime);\n    }\n    k++;\n  }\n  return phaseTimes;\n};\n\nexport {options, formatCI, sunrise, sunset, civilDawn, civilDusk, nauticalDawn,\n  nauticalDusk, astronomicalDawn, astronomicalDusk, solarNoon, yearMoonPhases,\n  roundToNearestMinute, returnTimeForPNMS};\n"],"names":["deg2rad","deg","rad2deg","rad","sind","Math","sin","cosd","cos","reduceAngle","angle","floor","polynomial","variable","coeffs","varPower","sum","numCoeffs","length","i","interpolateFromThree","y1","y2","y3","n","normalize","a","b","datetimeToJD","datetime","Y","year","M","month","D","date","hour","minute","second","A","gregorianCutoff","moment","B","isAfter","JDToDatetime","JD","Z","F","alpha","C","E","fracDay","day","hours","minutes","seconds","tz","JDToT","datetimeToT","DeltaT","u","t","y","approxK","kToT","k","truePhase","phase","T","timeConversions.kToT","eccentricityCorrection","JDE","meanPhase","sunMeanAnomaly","MPrime","moonMeanAnomaly","moonArgumentOfLatitude","Omega","moonAscendingNodeLongitude","planetaryArguments","DeltaJDE","newMoonFullMoonCorrections","quarterCorrections","commonCorrections","auxMath.sind","W","auxMath.cosd","sunMeanLongitude","meanObliquityOfEcliptic","moonMeanElongation","nutations","sunTransit","L","timezone","transit","timeConversions.DeltaT","timeConversions.datetimeToT","Theta0","apparentSiderealTimeGreenwhich","m","sunApparentRightAscension","normalizeM","utcOffset","sunTransitCorrection","add","roundToNearestMinute","sunRiseSet","phi","flag","offset","suntime","TD","delta","sunApparentDeclination","H0","approxLocalHourAngle","m0","counter","DeltaM","abs","sunRiseSetCorrection","subtract","returnPNMS","returnDate","returnTimeForPNMS","isDST","cosH0","special","auxMath.rad2deg","acos","localM","theta0","interpolatedRa","localHourAngle","interpolatedDec","H","altitude","auxMath.reduceAngle","asin","alpha1","alpha2","alpha3","auxMath.interpolateFromThree","delta1","delta2","delta3","epsilon","trueObliquityOfEcliptic","lambda","sunApparentLongitude","atan2","meanSiderealTimeGreenwhich","theta","nutationInLongitude","nutationInObliquity","auxMath.polynomial","constants.meanObliquityOfEcliptic","Sol","sunTrueLongitude","sunEquationOfCenter","sineArg","DeltaPsi","constants.nutations","cosArg","DeltaEpsilon","constants.moonArgumentOfLatitude","constants.moonAscendingNodeLongitude","constants.moonMeanAnomaly","constants.moonMeanElongation","constants.sunMeanAnomaly","L0","constants.sunMeanLongitude","dateFormatKeys","**","--","options","formatCI","formatString","customKey","creationData","input","slice","datestring","format","sunrise","sunTimes.sunRiseSet","err","sunTimes.returnPNMS","sunset","civilDawn","civilDusk","nauticalDawn","nauticalDusk","astronomicalDawn","astronomicalDusk","solarNoon","sunTimes.sunTransit","yearMoonPhases","yearBegin","yearEnd","phaseTimes","moonDatetime","moonPhases.truePhase","timeConversions.JDToDatetime","isBefore","push"],"mappings":"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"}